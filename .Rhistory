scale_fill_viridis_d(name="Type",
labels = c("Violent", "Property"),
begin = 0.3,
end=0.8) +
labs(title = "Number of crimes per state area",  y = "Nominal value")
mylegend <- g_legend(ggp1)
grid.arrange(arrangeGrob(ggp1 + theme(legend.position="none"),
ggp2 + theme(legend.position="none"),
nrow=1),
mylegend,
nrow=2,
heights=c(10, 1))
#create df with mean values across years per state from ucr
ucr_grouped <- ucr %>%
group_by(jurisdiction) %>%
summarise(violent_crime_total = mean(violent_crime_total),
property_crime_total = mean(property_crime_total))
#rename variable for merging
names(ucr_grouped)[names(ucr_grouped) == "jurisdiction"] <- "NAME"
#merge grouped ucr and state spatial data
us_states_ucr <- merge(us_states, ucr_grouped, by = "NAME")
#create values per population
us_states_ucr$violent_crime_per_pop <- us_states_ucr$violent_crime_total/us_states_ucr$total_pop_15
us_states_ucr$property_crime_per_pop <- us_states_ucr$property_crime_total/us_states_ucr$total_pop_15
us_states_midwest <- us_states %>%
filter(REGION=="Midwest") %>%
st_union() %>%
cbind(data.frame(REGION="Midwest")) %>%
st_sf()
us_states_norteast <- us_states %>%
filter(REGION=="Norteast") %>%
st_union() %>%
cbind(data.frame(REGION="Norteast")) %>%
st_sf()
us_states_south <- us_states %>%
filter(REGION=="South") %>%
st_union() %>%
cbind(data.frame(REGION="South")) %>%
st_sf()
us_states_west <- us_states %>%
filter(REGION=="West") %>%
st_union() %>%
cbind(data.frame(REGION="West")) %>%
st_sf()
us_states_regions <- rbind(us_states_midwest, us_states_norteast, us_states_south, us_states_west) %>% st_sf()
# create usa map for both crime types
usa1 <- ggplot() +
geom_sf(data = us_states_ucr, aes(fill = property_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Property crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
usa2 <- ggplot(data = us_states_ucr) +
geom_sf(data = us_states_ucr, aes(fill = violent_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Violent crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
# format main map
usa_all1 <- usa1 +
ggtitle("Property crimes per population across states")+
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
usa_all2 <- usa2 +
ggtitle("Violent crimes per population across states")+
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
# zoom and format zoomed map of DC
usa_dc1 <- usa1 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE)
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
usa_dc2 <- usa2 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
# combine both plots and add rectangle around zoomed area
ggp1 <- usa_all1 +
annotation_custom(ggplotGrob(usa_dc1), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
ggp2 <- usa_all2 +
annotation_custom(ggplotGrob(usa_dc2), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
ggp1
ggp2
prison_ucr = left_join(prison, ucr, by=c("jurisdiction", "year"))
prison_ucr$violent_crime_total_per_pop <- prison_ucr$violent_crime_total/prison_ucr$state_population
prison_ucr$property_crime_total_per_pop <- prison_ucr$property_crime_total/prison_ucr$state_population
prison_ucr$prisoners_per_pop <- prison_ucr$prison/prison_ucr$state_population
ggp1 <- ggplot(prison_ucr,
aes(x = prisoners_per_pop,
y = violent_crime_total_per_pop,
colour = as.factor(jurisdiction),
size = state_population,
frame = as.integer(year),
label = jurisdiction)) +
geom_point(show.legend = FALSE, alpha = 0.5) +
geom_text(size=2, hjust=-0.3, vjust=-0.3, color="black") +
scale_color_viridis_d() +
scale_size(range = c(2, 12)) +
labs(x = "Number of prisoners per capita", y = "Violent crimes total per capita") +
theme_minimal() +
theme(legend.position = "none")
ggp2 <- ggplot(prison_ucr,
aes(x = prisoners_per_pop,
y = property_crime_total_per_pop,
colour = as.factor(jurisdiction),
size = state_population,
frame = as.integer(year),
label = jurisdiction)) +
geom_point(show.legend = FALSE, alpha = 0.5) +
geom_text(size=2, hjust=-0.3, vjust=-0.3, color="black") +
scale_color_viridis_d() +
scale_size(range = c(2, 12)) +
labs(x = "Number of prisoners", y = "Property crimes total") +
theme_minimal() +
theme(legend.position = "none")
bubbles_v <- ggp1 + transition_time(as.integer(year)) +
labs(title = "Year: {frame_time}", range=c(2001L,2016L))
bubbles_p <- ggp2 + transition_time(as.integer(year)) +
labs(title = "Year: {frame_time}", range=c(2001L, 2016L))
# anim_save("bubbles_violent.gif", bubbles_v)
# anim_save("bubbles_property.gif", bubbles_p)
# preparing data
prison_data <- prison %>% filter(year==2001 | year==2016) %>%
select(jurisdiction, year, prison)
data_prep <- left_join(ucr, us_states_info, by = "jurisdiction")
data_prep1 <- left_join(data_prep, prison_data, by = c("jurisdiction", "year"))
v1 <- data_prep1 %>%
filter(year==2001) %>%
mutate(violent_crime_total_rate_2001 = violent_crime_total/state_population,
property_crime_total_rate_2001 = property_crime_total/state_population,
imprisonment_rate_2001 = prison/state_population) %>%
select(jurisdiction,
violent_crime_total_rate_2001,
property_crime_total_rate_2001,
imprisonment_rate_2001)
v2 <- data_prep1 %>%
filter(year==2016) %>%
mutate(violent_crime_total_rate_2016 = violent_crime_total/state_population,
property_crime_total_rate_2016 = property_crime_total/state_population,
imprisonment_rate_2016 = prison/state_population) %>%
select(jurisdiction,
violent_crime_total_rate_2016,
property_crime_total_rate_2016,
imprisonment_rate_2016)
final_data <- left_join(v1, v2, by = "jurisdiction")
# percentage change
final_data_plot <- final_data %>%
mutate(
pct_change_violent = (violent_crime_total_rate_2016-violent_crime_total_rate_2001)/(violent_crime_total_rate_2001)*100,
pct_change_property = (property_crime_total_rate_2016-property_crime_total_rate_2001)/(property_crime_total_rate_2001)*100,
pct_change_imprisonment = (imprisonment_rate_2016-imprisonment_rate_2001)/(imprisonment_rate_2001)*100) %>%
select(jurisdiction, pct_change_violent, pct_change_property, pct_change_imprisonment)
ggp_violent <- ggplot(data = final_data_plot,
aes(x = reorder(jurisdiction, -pct_change_violent),
y = pct_change_violent,
fill = as.factor(pct_change_violent),
text = paste0("Jurisdiction: ", jurisdiction,
"<br>Percentage change: ", round(pct_change_violent, 2), '%'))) +
geom_bar(stat='identity', position="dodge") +
scale_y_continuous(limits=c(-50, 220), breaks=seq(-50, 220, 50), labels=percent) +
coord_flip() +
labs(title = "Percent change in state violent crime rates, 2001-2016",
x = "Jurisdiction",
y = "Percentage change") +
scale_fill_viridis_d() +
theme_minimal() +
theme(legend.position = "none", axis.text=element_text(size=6))
ggp_property <- ggplot(data = final_data_plot,
aes(x = reorder(jurisdiction, pct_change_property),
y = pct_change_property,
fill = as.factor(pct_change_property),
text = paste0("Jurisdiction: ", jurisdiction,
"<br>Percentage change: ", round(pct_change_property, 2), '%'))) +
geom_bar(stat='identity') +
scale_y_continuous(limits=c(-50, 10), breaks=seq(-50, 10, 10), labels=percent) +
coord_flip() +
labs(title = "Percent change in state property crime rates, 2001-2016",
x = "Jurisdiction",
y = "Percentage change") +
scale_fill_viridis_d() +
theme_minimal() +
theme(legend.position = "none", axis.text=element_text(size=6))
ggp_imprisonment <- ggplot(data = final_data_plot,
aes(x = reorder(jurisdiction, -pct_change_imprisonment),
y = pct_change_imprisonment,
fill = as.factor(pct_change_imprisonment),
text = paste0("Jurisdiction: ", jurisdiction,
"<br>Percentage change: ", round(pct_change_imprisonment, 2), '%'))) +
geom_bar(stat='identity') +
coord_flip() +
labs(title = "Percent change in state imprisonment rates, 2001-2016",
x = "Jurisdiction",
y = "Percentage change") +
scale_fill_viridis_d() +
theme_minimal() +
scale_y_continuous(limits=c(-40, 80), breaks=seq(-40, 80, 10), labels=percent) +
theme(legend.position = "none", axis.text=element_text(size=6))
ggplotly(ggp_violent, tooltip = "text")
ggplotly(ggp_property, tooltip = "text")
ggplotly(ggp_imprisonment, tooltip = "text")
state_population <- ucr %>% select(jurisdiction, year, state_population, violent_crime_total, property_crime_total)
prison_exp_ext <- left_join(prison_exp, us_states_info, by = "jurisdiction")
prison_exp_ext1 <- left_join(prison_exp_ext, state_population, by = c("jurisdiction", "year"))
prison_exp_ext2 <- left_join(prison_exp_ext1, prison, by = c("jurisdiction", "year"))
prison_exp_ext2$exp_per_prisoner <- (prison_exp_ext2$prison_expenditure)/(prison_exp_ext2$prison)
prison_exp_ext2$violent_crime_per_pop <- (prison_exp_ext2$violent_crime_total)/(prison_exp_ext2$state_population)
prison_exp_ext2$property_crime_per_pop <- (prison_exp_ext2$property_crime_total)/(prison_exp_ext2$state_population)
# scatter plot of x and y variables
scatterPlot <- ggplot(prison_exp_ext2,
aes(exp_per_prisoner,
violent_crime_per_pop,
color=region,
frame=as.integer(year))) +
geom_point() +
scale_color_manual(values = viridis(5)) +
theme_minimal() +
labs(x = "Expenditures on prisons per prisoner", y = "Violent crimes per population", color = "Regions") +
theme(legend.position = "bottom")
my_legend_scatter <- g_legend(scatterPlot)
scatterPlot <- scatterPlot + theme(legend.position = "none")
scatterPlot <- scatterPlot + transition_time(as.integer(year))
# anim_save("scatterPlot.gif", scatterPlot)
# Marginal density plot of exp_per_prisoner (top panel)
xdensity <- ggplot(prison_exp_ext2,
aes(exp_per_prisoner, fill=as.factor(region))) +
geom_density(alpha=.5) +
scale_fill_manual(values = viridis(5)) +
theme_minimal() +
labs(x = "Expenditures on prisons per prisoner", y = "", fill="") +
theme(legend.position = "bottom")
my_legend_density <- g_legend(xdensity)
# xdensity + theme(legend.position = "none")
# ggsave("xdensity.png", width=7, height = 3)
# Marginal density plot of violent_crime_per_pop (right panel)
ydensity <- ggplot(prison_exp_ext2,
aes(violent_crime_per_pop, fill=region)) +
geom_density(alpha=.5) +
scale_fill_manual(values = viridis(5)) +
theme_minimal() +
labs(x = "Violent crimes per population", y="") +
theme(legend.position = "none")
# ydensity + coord_flip()
# ggsave("ydensity.png", width=3, height = 7)
blankPlot <- ggplot() +
geom_blank(aes(1,1)) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
# blankPlot
# ggsave("blankPlot.png", width=3, height = 3)
# as_ggplot(grid.arrange(my_legend_scatter, my_legend_density, ncol=2))
# ggsave("legends.png", width=10, height = 3)
data_to_cluster <- ucr %>% dplyr::select(-c(crime_reporting_change, crimes_estimated, violent_crime_total, property_crime_total))
data_to_cluster <- data_to_cluster %>%
group_by(jurisdiction) %>%
mutate(murder_manslaughter_per_pop = mean(murder_manslaughter/state_population),
robbery_per_pop = mean(robbery/state_population),
agg_assault_per_pop = mean(agg_assault/state_population),
burglary_per_pop = mean(burglary/state_population),
larceny_per_pop = mean(larceny/state_population),
vehicle_theft_per_pop = mean(vehicle_theft/state_population))
data_to_cluster <- data_to_cluster %>% select(-c(year, state_population, murder_manslaughter, robbery, agg_assault, burglary, larceny, vehicle_theft)) %>% distinct()
rownames(data_to_cluster) <- data_to_cluster$jurisdiction
data_to_cluster$jurisdiction <- NULL
data_to_cluster <- scale(data_to_cluster)
distance <- get_dist(data_to_cluster)
distance <- as.matrix(distance)
heatmaply(distance,
cellnote_size = 8, fontsize_row = 6, fontsize_col = 7,
Rowv = FALSE, Colv = FALSE,
main = 'Dissimilarity matrix for all states')
res.hc <- eclust(data_to_cluster, k=3, "hclust")
fviz_dend(res.hc,
rect = TRUE,
k_colors = viridis(3),
rect_border = viridis(8)[5],
main = "Clustering of states based on number of different kinds of crimes (3 clusters)",
cex = 0.7,
ggtheme = theme_minimal())
clusters <- data.frame(jurisdiction = rownames(data_to_cluster),
cluster = res.hc$cluster)
rownames(clusters) <- NULL
clusters <- clusters %>%
left_join(us_states_info, by = "jurisdiction") %>%
dplyr::select(jurisdiction, cluster, region)
table <- table(clusters$region, clusters$cluster)
colnames(table) <- c("Cluster 1", "Cluster 2", "Cluster 3")
kable_f(table)
#merge cluster data and state spatial data
colnames(clusters)[1] <- "NAME"
us_states_clusters <- merge(us_states, clusters, by = "NAME")
usa1 <- ggplot() +
geom_sf(data = us_states_clusters, aes(fill = as.factor(cluster)), lwd = 0, color="white") +
scale_fill_manual(values = viridis(6)[2:5], name = "Cluster") +
theme(legend.position = "none") +
theme_minimal() +
ggtitle("Mapping clusters and regions") +
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
usa1
#merge cluster data and state spatial data
colnames(clusters)[1] <- "NAME"
us_states_clusters <- merge(us_states, clusters, by = "NAME")
usa1 <- ggplot() +
geom_sf(data = us_states_clusters, aes(fill = as.factor(cluster)), lwd = 0, color="white") +
scale_fill_manual(values = viridis(6)[2:5], name = "Cluster") +
theme(legend.position = "none") +
theme_minimal() +
ggtitle("Mapping clusters and regions") +
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
usa1
clusters %>% arrange(cluster, region) %>% rename(Jurisdiction = NAME,
Clister = cluster,
Region = region)
clusters %>% arrange(cluster, region) %>% rename(Jurisdiction = NAME,
Cluster = cluster,
Region = region)
cat("State that is in ucr dataset but does not appear in prison dataset:\n",
setdiff(ucr$jurisdiction %>% unique(), prison$jurisdiction %>% unique()))
cat("State that is in ucr dataset but does not appear in private_prisons dataset:\n",
setdiff(ucr$jurisdiction %>% unique(), private_prisons$state %>% unique()))
#create df with mean values across years per state from ucr
ucr_grouped <- ucr %>%
group_by(jurisdiction) %>%
summarise(violent_crime_total = mean(violent_crime_total),
property_crime_total = mean(property_crime_total))
#rename variable for merging
names(ucr_grouped)[names(ucr_grouped) == "jurisdiction"] <- "NAME"
#merge grouped ucr and state spatial data
us_states_ucr <- merge(us_states, ucr_grouped, by = "NAME")
#create values per population
us_states_ucr$violent_crime_per_pop <- us_states_ucr$violent_crime_total/us_states_ucr$total_pop_15
us_states_ucr$property_crime_per_pop <- us_states_ucr$property_crime_total/us_states_ucr$total_pop_15
us_states_midwest <- us_states %>%
filter(REGION=="Midwest") %>%
st_union() %>%
cbind(data.frame(REGION="Midwest")) %>%
st_sf()
us_states_norteast <- us_states %>%
filter(REGION=="Norteast") %>%
st_union() %>%
cbind(data.frame(REGION="Norteast")) %>%
st_sf()
us_states_south <- us_states %>%
filter(REGION=="South") %>%
st_union() %>%
cbind(data.frame(REGION="South")) %>%
st_sf()
us_states_west <- us_states %>%
filter(REGION=="West") %>%
st_union() %>%
cbind(data.frame(REGION="West")) %>%
st_sf()
us_states_regions <- rbind(us_states_midwest, us_states_norteast, us_states_south, us_states_west) %>% st_sf()
# create usa map for both crime types
usa1 <- ggplot() +
geom_sf(data = us_states_ucr, aes(fill = property_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Property crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
usa2 <- ggplot(data = us_states_ucr) +
geom_sf(data = us_states_ucr, aes(fill = violent_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Violent crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
# format main map
usa_all1 <- usa1 +
ggtitle("Property crimes per population across states")+
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
usa_all2 <- usa2 +
ggtitle("Violent crimes per population across states")+
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
# zoom and format zoomed map of DC
usa_dc1 <- usa1 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE)
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
usa_dc2 <- usa2 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
# combine both plots and add rectangle around zoomed area
ggp1 <- usa_all1 +
annotation_custom(ggplotGrob(usa_dc1), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
ggp2 <- usa_all2 +
annotation_custom(ggplotGrob(usa_dc2), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
usa1 <- ggplot(data = us_states_ucr) +
geom_sf(aes(fill = property_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Property crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
usa2 <- ggplot(data = us_states_ucr) +
geom_sf(aes(fill = violent_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Violent crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
#create df with mean values across years per state from ucr
ucr_grouped <- ucr %>%
group_by(jurisdiction) %>%
summarise(violent_crime_total = mean(violent_crime_total),
property_crime_total = mean(property_crime_total))
#rename variable for merging
names(ucr_grouped)[names(ucr_grouped) == "jurisdiction"] <- "NAME"
#merge grouped ucr and state spatial data
us_states_ucr <- merge(us_states, ucr_grouped, by = "NAME")
#create values per population
us_states_ucr$violent_crime_per_pop <- us_states_ucr$violent_crime_total/us_states_ucr$total_pop_15
us_states_ucr$property_crime_per_pop <- us_states_ucr$property_crime_total/us_states_ucr$total_pop_15
us_states_midwest <- us_states %>%
filter(REGION=="Midwest") %>%
st_union() %>%
cbind(data.frame(REGION="Midwest")) %>%
st_sf()
us_states_norteast <- us_states %>%
filter(REGION=="Norteast") %>%
st_union() %>%
cbind(data.frame(REGION="Norteast")) %>%
st_sf()
us_states_south <- us_states %>%
filter(REGION=="South") %>%
st_union() %>%
cbind(data.frame(REGION="South")) %>%
st_sf()
us_states_west <- us_states %>%
filter(REGION=="West") %>%
st_union() %>%
cbind(data.frame(REGION="West")) %>%
st_sf()
us_states_regions <- rbind(us_states_midwest, us_states_norteast, us_states_south, us_states_west) %>% st_sf()
# create usa map for both crime types
usa1 <- ggplot(data = us_states_ucr) +
geom_sf(aes(fill = property_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Property crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
usa2 <- ggplot(data = us_states_ucr) +
geom_sf(aes(fill = violent_crime_per_pop), lwd = 0, color = "white") +
scale_fill_viridis_c(option = "viridis", trans = "sqrt", name = "Violent crimes\nper population") +
theme(legend.position = "none") +
theme_minimal()
# format main map
usa_all1 <- usa1 +
ggtitle("Property crimes per population across states")+
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
usa_all2 <- usa2 +
ggtitle("Violent crimes per population across states") +
theme(legend.position = "right") +
geom_sf(data = us_states_regions, aes(color=REGION), alpha=0, size = 0.8) +
scale_color_manual(values = heat.colors(6)[2:5], name = "Region")
# zoom and format zoomed map of DC
usa_dc1 <- usa1 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
usa_dc2 <- usa2 +
coord_sf(xlim = c(-79, -75), ylim = c(38, 40)) +
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text  = element_blank(),
axis.ticks = element_blank(),
legend.position = "none")
# combine both plots and add rectangle around zoomed area
ggp1 <- usa_all1 +
annotation_custom(ggplotGrob(usa_dc1), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
ggp2 <- usa_all2 +
annotation_custom(ggplotGrob(usa_dc2), xmin= -80, ymax= 35)+
geom_rect(aes(xmin = -79, xmax= -75, ymin=38, ymax = 40), size=0.6, fill=NA, color="black") +
guides(fill = guide_legend(order = 1), color = guide_legend(order = 2))
ggp1
ggp2
